<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Portal V21.0.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sidebar-bg: rgba(255, 255, 255, 0.95);
            --header-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #0f172a;
            --text-muted: #64748b;
            --primary: #0F2A4A; /* Deep Navy */
            --accent: #F05820;  /* Bright Orange */
            --border: #e2e8f0;
            --hover-bg: #f1f5f9;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0; 
            color: var(--text-dark); 
            height: 100vh; 
            overflow: hidden; 
            background: linear-gradient(rgba(15, 42, 74, 0.4), rgba(15, 42, 74, 0.4)), url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=2000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }

        /* --- LOGIN SCREEN --- */
        #login-view { 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            width: 100%; 
            height: 100%; 
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: 2000; 
            background: linear-gradient(rgba(15, 42, 74, 0.85), rgba(15, 42, 74, 0.9)), url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=2000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            transition: opacity 0.5s ease; 
        }

        .login-box-title {
            border: 3px solid white;
            padding: 20px 50px;
            margin-bottom: 60px;
            color: white;
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            background: rgba(255,255,255,0.1);
        }

        .login-form-container { width: 320px; display: flex; flex-direction: column; }
        .login-input { width: 100%; background: transparent; border: none; border-bottom: 1px solid rgba(255, 255, 255, 0.5); padding: 12px 0; color: white; font-size: 1.2rem; outline: none; margin-bottom: 50px; }
        .pill-btn { background-color: white; color: var(--primary); border: none; padding: 15px 0; width: 100%; border-radius: 50px; font-size: 0.95rem; font-weight: 800; cursor: pointer; text-transform: uppercase; }

        /* --- DASHBOARD --- */
        #dashboard-view { display: none; height: 100vh; width: 100%; }
        
        .sidebar { width: 260px; background-color: var(--sidebar-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; box-sizing: border-box; transition: width 0.3s ease; backdrop-filter: blur(10px); }
        .sidebar.collapsed { width: 80px; padding: 20px 10px; }
        .sidebar.collapsed .brand-text, .sidebar.collapsed .nav-text, .sidebar.collapsed .nav-section-label { display: none; }
        .sidebar.collapsed .brand { justify-content: center; }
        .sidebar.collapsed .nav-item { justify-content: center; padding: 12px; }

        .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 30px; font-weight: 700; font-size: 1.3rem; color: var(--primary); white-space: nowrap; overflow: hidden; }
        .brand-icon { min-width: 36px; height: 36px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 8px; color: white; display: flex; justify-content: center; align-items: center; font-weight: bold; }
        
        .nav-menu { list-style: none; padding: 0; margin: 0; flex: 1; }
        .nav-item { padding: 12px 15px; border-radius: 8px; color: var(--text-muted); cursor: pointer; margin-bottom: 5px; display: flex; align-items: center; gap: 12px; font-size: 0.95rem; font-weight: 500; transition: all 0.2s; white-space: nowrap; overflow: hidden; }
        .nav-item:hover { background-color: var(--hover-bg); color: var(--text-dark); }
        .nav-item.active { background-color: #eff6ff; color: var(--primary); font-weight: 600; }

        .main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .header { height: 70px; background: var(--header-bg); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 30px; backdrop-filter: blur(10px); }
        .header-clock { font-family: 'Oswald', sans-serif; font-size: 1.1rem; color: var(--primary); }
        
        .scroll-area { flex: 1; overflow-y: auto; padding: 40px; }
        .view-section { display: none; animation: fadeIn 0.3s ease-out; }
        .view-section.active { display: block; }

        /* CARDS & TOOLS */
        .card { background: rgba(255, 255, 255, 0.98); border-radius: 16px; padding: 40px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 900px; margin: 0 auto; }
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
        .card-title h2 { margin: 0 0 5px 0; font-size: 1.5rem; font-weight: 700; color: var(--text-dark); }
        
        /* BLUE ARROW BANNER */
        .bill-sec-title { 
            background-color: var(--primary); color: white; 
            padding: 8px 30px 8px 15px; font-weight: 800; text-transform: uppercase; 
            margin-bottom: 15px; font-size: 0.85rem; width: fit-content; min-width: 150px;
            clip-path: polygon(0% 0%, 90% 0%, 100% 50%, 90% 100%, 0% 100%); 
        }

        .bill-calc-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px dashed var(--border); }
        .bill-total-bar { 
            background-color: var(--primary); color: white; 
            padding: 10px 30px 10px 15px; font-weight: 700; display: flex; justify-content: space-between; 
            clip-path: polygon(0% 0%, 95% 0%, 100% 50%, 95% 100%, 0% 100%); margin-top: 15px;
        }

        /* INPUTS */
        .input, .select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; box-sizing: border-box; }
        .btn-primary { background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 700; }
        
        /* TROUBLESHOOTING GRID */
        .ts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .ts-card { border: 1px solid var(--border); border-radius: 12px; background: white; padding: 20px; display:flex; flex-direction:column; justify-content:space-between; }
        .ts-name { font-weight: 700; color: var(--text-dark); margin-bottom: 10px; font-size: 1.1rem; }
        .ts-details { font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; white-space: pre-wrap; margin-bottom: 15px; }

        /* PORTING LIST */
        .port-list { list-style: none; padding: 0; }
        .port-item { border: 1px solid var(--border); background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; cursor: pointer; }
        .port-header { display: flex; justify-content: space-between; font-weight: 600; }
        .port-details { display: none; padding-top: 10px; margin-top: 10px; border-top: 1px solid #eee; font-size: 0.9rem; color: #444; }
        .port-item.expanded .port-details { display: block; }

        /* MODAL */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 3000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
        .modal-box { background: white; width: 450px; padding: 40px; border-radius: 12px; text-align: center; border: 2px solid var(--accent); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="login-view">
        <div class="login-box-title">WORK PORTAL</div>
        <form id="login-form" class="login-form-container">
            <label class="login-label">Password</label>
            <input type="password" id="password-input" class="login-input">
            <button type="submit" class="pill-btn">ENTER</button>
        </form>
        <div id="login-error">Access Denied</div>
    </div>

    <div id="dashboard-view" style="display:flex;">
        <div class="sidebar collapsed" id="app-sidebar">
            <div class="brand"><div class="brand-icon">S</div><div class="brand-text">Sales Portal</div></div>
            <ul class="nav-menu">
                <li class="nav-item active" id="nav-home" onclick="switchView('view-home')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg> <span class="nav-text">Home</span></li>
                <li class="nav-item" id="nav-calc" onclick="switchView('view-calc')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><line x1="8" y1="2" x2="8" y2="6"></line><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg> <span class="nav-text">EasyPay Calculator</span></li>
                <li class="nav-item" id="nav-estimator" onclick="switchView('view-estimator')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path></svg> <span class="nav-text">Plan Estimator</span></li>
                <li class="nav-item" id="nav-bill" onclick="switchView('view-bill')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> <span class="nav-text">Bill Estimator</span></li>
                <li class="nav-item" id="nav-troubleshoot" onclick="switchView('view-troubleshoot')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg> <span class="nav-text">Quick Fix</span></li>
                <li class="nav-item" id="nav-contract" onclick="switchView('view-contract')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> <span class="nav-text">EasyPay Contract</span></li>
                <li class="nav-item" id="nav-porting" onclick="switchView('view-porting')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> <span class="nav-text">Porting Contacts</span></li>
            </ul>
            <div class="nav-section">
                <div class="nav-section-label">System</div>
                <ul class="nav-menu">
                    <li class="nav-item" id="nav-support" onclick="switchView('view-support')"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg> <span class="nav-text">Support</span></li>
                    <li class="nav-item" id="logout-btn"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg> <span class="nav-text">Sign out</span></li>
                </ul>
            </div>
        </div>

        <div class="main-content">
            <div class="header">
                <div class="header-left">
                    <div class="menu-toggle" onclick="toggleSidebar()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div>
                </div>
                <div class="header-clock" id="live-clock"></div>
            </div>
            <div class="scroll-area">
                
                <div id="view-home" class="view-section active"></div>

                <div id="view-calc" class="view-section">
                    <div class="card" style="max-width:500px;">
                        <h2>EasyPay Calculator</h2>
                        <input type="number" id="q-price" class="input" placeholder="Retail Price ($)" oninput="runCalc()">
                        <div style="margin-bottom:20px;">
                            <label><input type="radio" name="q-type" id="q-phone" checked onchange="runCalc()"> Phone</label>
                            <label style="margin-left:20px;"><input type="radio" name="q-type" id="q-watch" onchange="runCalc()"> Watch</label>
                        </div>
                        <div class="calc-panel">
                            <div class="bill-calc-row"><span>Sales Tax (8.9%)</span><span id="res-tax">$0.00</span></div>
                            <div class="bill-calc-row"><span>Down Payment</span><span id="res-down">$0.00</span></div>
                            <div class="bill-calc-row"><span>Monthly (24mo)</span><span id="res-mo">$0.00</span></div>
                            <div class="bill-total-bar"><span>DUE TODAY</span><span id="res-total">$0.00</span></div>
                        </div>
                    </div>
                </div>

                <div id="view-bill" class="view-section">
                    <div class="card" style="max-width:800px;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
                            <h2>First Bill Estimator</h2>
                            <button class="btn-primary" onclick="printBill()">Generate Bill PDF</button>
                        </div>
                        <div class="bill-sec-title">Monthly Rate Plan</div>
                        <div class="bill-calc-row"><span>Select Rate Plan</span><select id="be-plan-select" class="input" style="width:250px; margin:0;" onchange="runBillMath()"></select></div>
                        <div class="bill-calc-row"><span>Number of Lines</span><input type="number" id="be-lines" class="input" style="width:80px; margin:0;" value="1" min="1" max="7" oninput="runBillMath()"></div>
                        <div class="bill-calc-row"><span>AARP/USAA Discount (5%)</span><input type="checkbox" id="be-aarp" onchange="runBillMath()" style="width:22px; height:22px;"></div>
                        <div class="bill-total-bar"><span>ESTIMATED MONTHLY</span><span id="be-res-total">$0.00</span></div>
                    </div>
                </div>

                <div id="view-troubleshoot" class="view-section">
                    <div class="card" style="max-width:1000px;">
                        <h2>Quick Fix Guides</h2>
                        <input type="text" id="ts-search" class="input" placeholder="Search devices (iPhone, S25, Razr...)" onkeyup="searchTS()" style="margin-bottom:30px;">
                        <div class="ts-grid" id="ts-container"></div>
                    </div>
                </div>

                <div id="view-porting" class="view-section">
                    <div class="card">
                        <h2>Porting Contacts</h2>
                        <input type="text" id="port-search" class="input" placeholder="Search carrier name..." onkeyup="searchPort()" style="margin-bottom:20px;">
                        <ul class="port-list" id="port-container"></ul>
                    </div>
                </div>

                <div id="view-contract" class="view-section">
                    <div class="card">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
                            <h2>EasyPay Contract</h2>
                            <button class="btn-primary" onclick="handleContractGen()">Generate Agreement</button>
                        </div>
                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                            <div><label class="label">Full Name</label><input type="text" id="c-name" class="input" placeholder="John Doe"></div>
                            <div><label class="label">Account Number</label><input type="text" id="c-acct" class="input" placeholder="123456789"></div>
                        </div>
                        <label class="label">Device Name</label><input type="text" id="c-dev" class="input" placeholder="e.g. iPhone 17 Pro Max">
                        <label class="label">Retail Price ($)</label><input type="number" id="c-price" class="input" placeholder="0.00" oninput="runConMath()">
                        <div style="margin:10px 0 25px;">
                            <label><input type="radio" name="c-type" id="c-phone" checked onchange="runConMath()"> Phone</label>
                            <label style="margin-left:30px;"><input type="radio" name="c-type" id="c-watch" onchange="runConMath()"> Watch</label>
                        </div>
                        <div class="calc-panel">
                            <div class="bill-calc-row"><span>Monthly Payment</span><span id="con-res-mo">$0.00</span></div>
                            <div class="bill-total-bar"><span>DUE TODAY</span><span id="con-res-total">$0.00</span></div>
                        </div>
                    </div>
                </div>
                
                 <div id="view-estimator" class="view-section">
                    <div class="card" style="max-width:1000px;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
                            <h2>Plan Estimator</h2>
                            <button class="btn-primary" onclick="printPlan()">Print Plan Details</button>
                        </div>
                        <div class="split-view">
                            <div class="plan-list" id="plan-list-cont"></div>
                            <div class="plan-detail-view" id="plan-detail-cont">Select a plan to view pricing and data usage examples.</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="hv-modal" class="modal-overlay">
        <div class="modal-box">
            <div style="font-size:50px; margin-bottom:15px;">⚠️</div>
            <h3 style="color:var(--accent); margin-top:0;">High Value Approval</h3>
            <p>This transaction exceeds <strong>$700.00</strong>.</p>
            <p>You must call <strong>CC EasyPay Credit</strong> at <strong>(877) 803-0176</strong> for authorization before printing.</p>
            <button class="btn-primary" style="width:100%; margin-top:20px;" onclick="confirmHV()">I Have Called Credit</button>
            <button onclick="closeHV()" style="background:none; border:none; color:#64748b; margin-top:15px; cursor:pointer; text-decoration:underline;">Cancel</button>
        </div>
    </div><script>
    // --- 1. CORE SYSTEM & AUTH ---
    const authPass = 'spokanecc';
    document.getElementById('login-form').onsubmit = (e) => {
        e.preventDefault();
        if(document.getElementById('password-input').value.toLowerCase() === authPass) {
            document.getElementById('login-view').style.display = 'none';
            document.getElementById('dashboard-view').style.display = 'flex';
            initApplication();
        } else {
            document.getElementById('login-error').style.display = 'block';
        }
    };

    function toggleSidebar() { document.getElementById('app-sidebar').classList.toggle('collapsed'); }
    function switchView(id) {
        document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    }

    setInterval(() => {
        document.getElementById('live-clock').innerText = new Date().toLocaleString('en-US', { weekday: 'short', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }, 1000);

    // --- 2. EASYPAY LOGIC ---
    function getMath(price, isPhone) {
        price = parseFloat(price) || 0;
        const tax = price * 0.089;
        let monthly = 0, down = 0;
        if (price > 0) {
            if (isPhone) {
                monthly = Math.floor(price / 24);
                down = price - (monthly * 24);
            } else {
                monthly = Math.ceil((price / 24) * 100) / 100;
                down = 0;
            }
        }
        return { tax, down, monthly, totalToday: down + tax };
    }

    function runCalc() {
        const m = getMath(document.getElementById('q-price').value, document.getElementById('q-phone').checked);
        document.getElementById('res-tax').innerText = "$" + m.tax.toFixed(2);
        document.getElementById('res-down').innerText = "$" + m.down.toFixed(2);
        document.getElementById('res-mo').innerText = "$" + m.monthly.toFixed(2);
        document.getElementById('res-total').innerText = "$" + m.totalToday.toFixed(2);
    }

    function runConMath() {
        const m = getMath(document.getElementById('c-price').value, document.getElementById('c-phone').checked);
        document.getElementById('con-res-mo').innerText = "$" + m.monthly.toFixed(2);
        document.getElementById('con-res-total').innerText = "$" + m.totalToday.toFixed(2);
    }

    function handleContractGen() {
        const p = parseFloat(document.getElementById('c-price').value) || 0;
        if (p > 700) document.getElementById('hv-modal').style.display = 'flex';
        else finalizeContractPDF();
    }
    function closeHV() { document.getElementById('hv-modal').style.display = 'none'; }
    function confirmHV() { closeHV(); finalizeContractPDF(); }

    function finalizeContractPDF() {
        const name = document.getElementById('c-name').value || "Customer";
        const m = getMath(document.getElementById('c-price').value, document.getElementById('c-phone').checked);
        const win = window.open('', '_blank');
        win.document.write(`<html><body style="font-family:sans-serif; padding:50px;"><h1>EasyPay Agreement</h1><hr><p>Customer: ${name}</p><p>Monthly: $${m.monthly.toFixed(2)}</p><p>Due Today: $${m.totalToday.toFixed(2)}</p><script>window.print();<\/script></body></html>`);
        win.document.close();
    }

    // --- 3. DATABASES ---
    const plans = [
        {name: "The Minimalist", price: 20, data: "1GB", desc: "For basic calling and texting."},
        {name: "The Sometimes-On", price: 25, data: "5GB", desc: "Perfect for light social media."},
        {name: "The Scroller", price: 35, data: "10GB", desc: "Ideal for daily smartphone use."},
        {name: "The Streamer", price: 45, data: "20GB", desc: "Best for video and music fans."},
        {name: "Unlimited", price: 60, data: "Unlimited", desc: "No data caps or worries."},
        {name: "Unlimited (50+)", price: 40, data: "Unlimited", desc: "Senior special (1 Line)."},
        {name: "Unlimited for AARP", price: 55, data: "Unlimited", desc: "2 Lines Required."}
    ];

    const carriers = [
        {name: "Verizon Wireless", num: "888-844-7095", pin: "Number Transfer PIN via #PORT. Valid 7 days."},
        {name: "AT&T Wireless", num: "877-844-5584", pin: "Port-out PIN via *PORT. Valid 4 days."},
        {name: "T-Mobile", num: "877-789-3106", pin: "NTP via T-Mobile App/Account Hub."},
        {name: "Straight Talk / Tracfone", num: "800-327-2077", pin: "Text NTP to 611611."},
        {name: "Spectrum Mobile", num: "833-224-6603", pin: "Account PIN found on page 1 of bill."},
        {name: "Xfinity Mobile", num: "877-547-7230", pin: "NTP available in Xfinity App settings."},
        {name: "Cricket Wireless", num: "800-274-2538", pin: "NTP via *PORT or Account Portal."},
        {name: "Boost Mobile", num: "833-642-6678", pin: "Call 611 or Port Dept to request PIN."},
        {name: "Mint Mobile", num: "800-683-7392", pin: "Request via App > Account > Port Out."},
        {name: "Google Fi", num: "844-825-5234", pin: "Unlock number via Fi app settings."},
        {name: "Lively / Jitterbug", num: "800-733-6632", pin: "Call CS to get unique alphanumeric PIN."},
        {name: "US Cellular", num: "888-900-7678", pin: "Call Port Dept for PIN."},
        {name: "Consumer Cellular", num: "888-345-5509", pin: "Last 4 of Primary SSN (Default)."},
        {name: "Metro by T-Mobile", num: "888-863-8768", pin: "NTP via MyMetro App."},
        {name: "Visible", num: "Chat via App", pin: "Request Port PIN in App Profile."},
        {name: "PureTalk", num: "877-817-8255", pin: "Call Customer Service."},
        {name: "Red Pocket", num: "888-993-3888", pin: "Available in Online Account."},
        {name: "Simple Mobile", num: "877-878-7908", pin: "Text NTP to 611611."},
        {name: "Total Wireless", num: "866-663-3633", pin: "Text NTP to 611611."},
        {name: "Net10", num: "877-836-2368", pin: "Text NTP to 611611."},
        {name: "Page Plus", num: "800-550-2436", pin: "Text NTP to 611611."},
        {name: "Walmart Family Mobile", num: "877-440-9758", pin: "Text NTP to 611611."},
        {name: "SafeLink", num: "800-723-3546", pin: "Usually Enrollment ID or call CS."},
        {name: "Assurance Wireless", num: "888-321-5880", pin: "6-digit PIN from Account."},
        {name: "H2O Wireless", num: "800-643-4917", pin: "Call CS for Port PIN."},
        {name: "Lyca Mobile", num: "866-277-3221", pin: "Call CS for PAC code."},
        {name: "Ultra Mobile", num: "888-777-0446", pin: "Call CS for Account/PIN."}
    ];

    const tsGuides = [
        {title: "iPhone 17 Pro Max", content: "1. Cellular Fix: Settings > Cellular > Toggle main plan Off then On after 30s. 2. Network Reset: Settings > General > Transfer or Reset > Reset Network Settings. 3. VoiceOver: If speaking, tap once to select, double-tap to toggle Off."},
        {title: "iPhone 17 Pro", content: "1. Display lag: Verify Low Power Mode is Off. 2. Force Restart: Up volume, Down volume, hold Power button until logo shows."},
        {title: "iPhone 17 Air", content: "1. Battery: Go to Settings > Battery and check for high-usage apps. 2. Toggle Background Refresh in General settings."},
        {title: "iPhone 17", content: "1. Connection: Cycle Airplane Mode for 10s. 2. Update carrier settings in Settings > General > About menu."},
        {title: "iPhone 16 Series", content: "1. SIM Reseat: Remove physical SIM tray and clean contacts. 2. Reset Safari browser history in Settings > Safari."},
        {title: "Samsung S25 Ultra", content: "1. Safe Mode: Power off, then hold Power + Volume Down while starting. 2. Wipe Cache: Power + Volume Up at startup to enter recovery menu."},
        {title: "Samsung S25 FE", content: "1. App Crash: Go to Settings > Apps > [App Name] > Storage > Clear Cache. 2. Run Device Care optimizer."},
        {title: "Samsung S25 Edge", content: "1. Edge Panel: Toggle off in Display settings if accidental touches occur. 2. Recalibrate Screen Sensitivity in Display menu."},
        {title: "Samsung S25", content: "1. eSIM: Settings > Connections > SIM manager > Toggle plan off/on. 2. System UI Reset: Force stop System UI in apps list."},
        {title: "Galaxy Z Fold 7", content: "1. Hinge Sensors: Open and close fully 3 times quickly. 2. Screen: Clean inner display with microfiber only."},
        {title: "Galaxy Z Flip 7 FE", content: "1. Cover Screen: Remove widgets and add back 1 by 1. 2. Camera Shutter lag: Turn off Scene Optimizer."},
        {title: "Galaxy A15 (Physical SIM)", content: "1. Network: Turn off, remove SIM for 60s, reinsert, turn on. 2. TalkBack: Settings > Accessibility > TalkBack > OFF."},
        {title: "Galaxy A36 5G (eSIM)", content: "1. Network: Settings > Connections > SIM manager > Toggle eSIM. 2. RAM Plus: Lower the value in Battery/Device Care."},
        {title: "Galaxy Tab A11+", content: "1. Multi-User: Switch profiles and back to clear glitches. 2. Dex Mode: Toggle on/off if display looks strange."},
        {title: "Moto Razr 2025", content: "1. Connection: Settings > Network > Internet > Toggle Mobile Data. 2. Proximity: Clean cover screen sensor area."},
        {title: "Moto G Power 2025", content: "1. Battery Saver: Ensure main saver mode is off. 2. Fingerprint: Delete and re-register fingerprint if failing."},
        {title: "Moto G Stylus 2025", content: "1. Stylus: Remove and re-insert firmly. 2. Screen Record: Force stop service in Apps if notification sticks."},
        {title: "Moto Edge 2024", content: "1. Display: Adjust Accidental Touch Prevention. 2. Ready For: Disconnect and reset desktop mode."},
        {title: "Google Pixel 10", content: "1. Connectivity: Disable Adaptive Connectivity for 5 mins. 2. Re-index search in Google App settings."},
        {title: "Iris Eazy Flip", content: "1. T9 Input: Cycle text modes with # key. 2. Contrast: Settings > Display > Max Contrast. 3. Volume: Test side keys."},
        {title: "Verve Home Base", content: "1. Power Cycle: Unplug 2 mins. 2. Signal: Ensure base is near a window. 3. Voicemail: Set up via *86."},
        {title: "Iris Ally necklace", content: "1. SOS Button: Press and cancel immediately to test link. 2. Charging: Ensure base light is green when seated."}
    ];

    // --- 4. RENDER FUNCTIONS ---
    function initApplication() {
        const pSel = document.getElementById('be-plan-select');
        plans.forEach((p, i) => { const opt = document.createElement('option'); opt.value = i; opt.text = `${p.name} ($${p.price})`; pSel.appendChild(opt); });

        const tsc = document.getElementById('ts-container'); tsc.innerHTML = '';
        tsGuides.forEach(g => {
            const el = document.createElement('div'); el.className = 'ts-card';
            el.innerHTML = `<div class="ts-name">${g.title}</div><div class="ts-details">${g.content}</div><button class="pill-btn" style="background:var(--primary); color:white; padding:10px; font-size:0.75rem;" onclick="printTS('${g.title}')">Print Guide</button>`;
            tsc.appendChild(el);
        });

        const pc = document.getElementById('port-container'); pc.innerHTML = '';
        carriers.sort((a,b)=>a.name.localeCompare(b.name)).forEach(c => {
            const el = document.createElement('div'); el.className = 'port-item';
            el.onclick = () => el.classList.toggle('expanded');
            el.innerHTML = `<div style="display:flex; justify-content:space-between; font-weight:700;"><span>${c.name}</span><span style="color:var(--accent);">${c.num}</span></div><div class="port-details"><strong>Rules:</strong> ${c.pin}</div>`;
            pc.appendChild(el);
        });
        
        const estList = document.getElementById('plan-list-cont'); estList.innerHTML = '';
        plans.forEach((p, i) => {
            const el = document.createElement('div'); el.className = 'port-item';
            el.innerText = p.name; el.onclick = () => selectPlan(i);
            estList.appendChild(el);
        });
        runBillMath();
    }

    let currentSelectedPlan = null;
    function selectPlan(i) {
        currentSelectedPlan = plans[i];
        document.getElementById('plan-detail-cont').innerHTML = `<h3>${currentSelectedPlan.name}</h3><p style="font-size:1.5rem; font-weight:800; color:var(--accent);">$${currentSelectedPlan.price}/mo</p><p>${currentSelectedPlan.desc}</p><p><strong>Data Included:</strong> ${currentSelectedPlan.data}</p>`;
    }

    function filterTS() {
        const q = document.getElementById('ts-search').value.toLowerCase();
        document.querySelectorAll('.ts-card').forEach(c => c.style.display = c.innerText.toLowerCase().includes(q) ? 'flex' : 'none');
    }
    function filterPort() {
        const q = document.getElementById('port-search').value.toLowerCase();
        document.querySelectorAll('.port-item').forEach(i => i.style.display = i.innerText.toLowerCase().includes(q) ? 'block' : 'none');
    }

    function runBillMath() {
        const plan = plans[document.getElementById('be-plan-select').value];
        const lines = parseInt(document.getElementById('be-lines').value) || 1;
        let total = plan.price;
        if(lines > 1) total += (lines - 1) * 15;
        if(document.getElementById('be-aarp').checked) total *= 0.95;
        document.getElementById('be-res-total').innerText = "$" + total.toFixed(2);
    }

    function printBill() {
        const val = document.getElementById('be-res-total').innerText;
        const win = window.open('', '_blank');
        win.document.write(`<html><head><style>@import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap');body{padding:0; margin:0; font-family:sans-serif; color:#102B4A;}.header{background:#0F2A4A; color:white; padding:40px; display:flex; justify-content:space-between; align-items:center;}.logo{background:#F05820; padding:15px; color:white; font-weight:bold;}.arrow{background:#0F2A4A; color:white; padding:10px 40px; clip-path:polygon(0% 0%, 92% 0%, 100% 50%, 92% 100%, 0% 100%); margin-top:40px; font-weight:bold; font-size:1.2rem;}.total-box{border:5px solid #102B4A; margin:40px; padding:30px; display:flex; justify-content:space-between; font-size:2rem; font-weight:800;}</style></head><body><div class="header"><h1>ESTIMATED FIRST BILL</h1><div class="logo">Consumer Cellular</div></div><div class="arrow">MONTHLY RATE PLAN</div><div class="total-box"><span>GRAND TOTAL</span><span>${val}</span></div><script>window.print();<\/script></body></html>`);
        win.document.close();
    }

    function printPlan() {
        if(!currentSelectedPlan) return alert("Select a plan first");
        const win = window.open('', '_blank');
        win.document.write(`<html><head><style>body{padding:40px; font-family:sans-serif; color:#102B4A;} .header{border-bottom:5px solid #F05820; padding-bottom:20px; margin-bottom:40px;} .price{font-size:3rem; color:#F05820; font-weight:800;}</style></head><body><div class="header"><h1>Plan Selection: ${currentSelectedPlan.name}</h1></div><div class="price">$${currentSelectedPlan.price}/mo</div><p style="font-size:1.5rem;">${currentSelectedPlan.desc}</p><script>window.print();<\/script></body></html>`);
        win.document.close();
    }

    function printTS(title) {
        const guide = tsGuides.find(g => g.title === title);
        const win = window.open('', '_blank');
        win.document.write(`<html><head><style>body{padding:50px; font-family:sans-serif; color:#102B4A;} .header{border-bottom:5px solid #F05820; padding-bottom:20px; margin-bottom:40px;}</style></head><body><div class="header"><h1>Quick Fix: ${guide.title}</h1></div><p style="font-size:1.5rem; line-height:1.6; white-space:pre-wrap;">${guide.content}</p><script>window.print();<\/script></body></html>`);
        win.document.close();
    }
</script>
</body>
</html>
